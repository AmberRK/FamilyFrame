<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Family Frame</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
    <link rel="icon" href="../images/familyFrameLogo.svg" type="image/svg+xml">

</head>


<body onload="javascript: getMyTrees()">
    <div id="flex-container">
        <div id="navbarPlaceholder"></div>

        <div>
            <h2>My Trees</h2>
            <br>
        </div>

        <!-- <div id="JWT test">
            <button onclick="getMyTrees()">Get My Trees (on load)</button>
        </div> -->
        <!-- <div id="debugTrees">
            <button onclick="getALLTrees()">Get ALL Trees. To test adding a tree by code</button>
        </div> -->
        <div id="myTreesDiv">
            <h3>Trees I created</h3>
            <table id="showMyTrees">
                <th>Name</th>
                <th>Share Code</th>
            </table>
            <br>
        </div>

        <div id="sharedTreesDiv">
            <h3>Trees shared with me</h3>
            <table id="showALLTrees">
                <th>Name</th>
            </table>
            <br>
            <br>
        </div>
        <section id="makeTreeDiv" class="modal hidden">
            <div class="flex">
                <button class="btn-close">⨉</button>
            </div>
            <div>
                <h3>Create a tree</h3>
            </div>
            <form id="submitName">
                <input type="text" autocomplete="off" name="treeName" id="treeName"
                    placeholder="Family Name" />
                <input class="submit" id="submitTree" type="submit" value="Create tree" onClick="createTree()">
            </form>
        </section>

        <div class="overlay hidden"></div>
        <button class="btn btn-open">Create a tree</button>

        <section class="modal hidden">
            <div class="flex">
                <button class="btn-close">⨉</button>
            </div>
            <div>
                <h3>Add a tree via a share code</h3>
            </div>
            <form id="submitCode">
                <input type="text" autocomplete="off" name="shareCode" id="shareCode"
                    placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" />
                <input class="submit" id="submitCode" type="submit" value="Add tree" onClick="addATree()">
            </form>

        </section>

        <div class="overlay hidden"></div>
        <button class="btn btn-open">Add a tree with a code</button>

        <div id="popup" class="popup">
            <p>Are you sure?</p>
            <div class="popup-buttons">
                <button id="yesButton" class="popup-button">Yes</button>
                <button id="noButton" class="popup-button">No</button>
            </div>
        </div>

        <!--<form id="addTreeName">
            <input type="text" autocomplete="off" name="nameTree" id="nameTree"
                placeholder="Family Name" />
            <input class="submit" id="submitTreeName" type="submit" value="Add tree" onClick="createTree()">
        </form> -->


        <footer>
            <div id="footerPlaceholder"></div>
        </footer>

        <script>
        </script>
        <script src="scripts/leader-line.min.js"></script>
        <script src="scripts/main.js"></script>
        <script src="scripts/transaction.js"></script>
        <script src="scripts/navbar.js"></script>
        <script src="scripts/footer.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                replacePlaceholderFooter();
            });
            const modal = document.querySelectorAll(".modal");
            const overlay = document.querySelectorAll(".overlay");
            const openModalBtn = document.querySelectorAll(".btn-open");
            const closeModalBtn = document.querySelectorAll(".btn-close");
            console.log(modal);
            console.log(overlay);
            console.log(openModalBtn);
            console.log(closeModalBtn);

            // close modal function

            function openModal(modal, overlay) {
                modal.classList.remove("hidden");
                overlay.classList.remove("hidden");
            }

        // Function to close a modal
        function closeModal(modal, overlay) {
            modal.classList.add("hidden");
            overlay.classList.add("hidden");
        }

        // Add click event listeners to open buttons
        openModalBtn.forEach((button, index) => {
        const correspondingModal = modal[index];
        const correspondingOverlay = overlay[index];

        button.addEventListener("click", () => {
            openModal(correspondingModal, correspondingOverlay);
        });
    });

    // Add click event listeners to close buttons and overlays
    closeModalBtn.forEach((button, index) => {
    const correspondingModal = modal[index];
    const correspondingOverlay = overlay[index];

    button.addEventListener("click", () => {
        closeModal(correspondingModal, correspondingOverlay);
    });
    
    correspondingOverlay.addEventListener("click", () => {
        closeModal(correspondingModal, correspondingOverlay);
    });
    });

    // Add event listener for Esc key to close modals
    document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
        modals.forEach((modal, index) => {
            if (!modal.classList.contains("hidden")) {
                closeModal(modal, overlays[index]);
            }
        });
    }
    });
        </script>
    </div>
</body>

</html>
